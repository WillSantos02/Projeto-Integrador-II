<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="../css/generate.css">
        <link rel="stylesheet" href="../css/components.css">
        
        <link rel="icon" type="image/x-icon" href="../assets/icons/favicon.ico">

        <script src="../js/copyFunction.js"></script>

        <title>FasTICKET: Gere um novo código e disfrute de ser Fast!</title>
    </head>
    
    <body>
        <!-- Navbar -->
        <header>
            <nav>
                <abbr title="Ir para Home">
                    <img class="logo" id="navbar" src="../assets/logo/FASTICKET.svg" alt="Ir para Home" onclick="location.href='../index.html'">
                </abbr>

                <ul class="nav-list">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="about_ous_view/aboutOus.html">Sobre</a></li>
                    <li><a href="relatorio.html">Relatórios</a></li>
                    <li class="disable">Para empresas</li>
                </ul>

                <ul class="nav-list">
                    <li>
                        <div class="buttons">
                            <button type="button" onclick="location.href='mainTicket.html'" class="btn-nav">
                                Meu bilhete
                            </button>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>
        <!-- Navbar -->

        <main>
            <section class="code-generate" id="qrCodeSection">
                <h1>Gerar novo bilhete</h1>

                <img class ="qr-code"src="https://api.qrserver.com/v1/create-qr-code/?data=qrcode_example&size=183x183" alt="qr code" id="qrCodeImg"/>

                <div class="text-code">
                    <input type="text" value="" id="ticketCode" readonly placeholder="xxxxxxxx-xxxx-xxxx-xxxxx-xxxxxxxxxxxx">
                    
                    <div class="tooltip">
                        <button class="icon-copy" onclick="myFunction()" onmouseout="outFunc()">
                            <span class="tooltiptext" id="myTooltip">Copiar</span>
                            <img src="../assets/icons/icon_copy.svg">
                        </button>
                    </div>
                </div>

                <div class="buttons">
                    <form action="" method="post">
                        <button type="button" class="generic-btn generate-btn">
                            Gerar código
                        </button>
                    </form>

                    <form action="" method="post">
                        <button type="button" onclick="location.href='recharge.html'" class="generic-btn recharge-btn">
                            Recarregar
                        </button>
                    </form>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer>
            <div class="container-footer">
                <nav class="nav-footer">
                    <ul class="nav-list-footer">
                        <li><a href="#navbar">Voltar ao inicio</a></li>
                    </ul>
                </nav>

                <div class="row-footer">
                    <div class="footer-col">
                        <h4>Sobre o FasTICKET</h4>
                        <ul>
                            <li><a href="about_ous_view/aboutOus.html">Sobre nos</a></li>
                            <li><a href="about_ous_view/contact.html">Contato</a></li>
                            <li><a href="about_ous_view/FasTICKET-responsabilities.html">Responsabilidades</a></li>
                            <li><a href="about_ous_view/careers.html">Trabalhe conosco</a></li>
                        </ul>
                    </div>
                    
                    <div class="footer-col">
                        <h4>Bilhetes</h4>
                        <ul>
                            <li><a href="tickets.html">Ações Rápidas</a></li>
                            <li><a href="generate.html">Gerar novo bilhete</a></li>
                            <li><a href="recharge.html">Recarregar bilhete</a></li>
                            <li><a href="mainTicket.html">Utilizar Bilhetes</a></li>
                            <li><a href="relatorio.html">Relatório de uso</a></li>
                            <li><a href="#">Rel. de recarga</a></li>
                        </ul>
                    </div>

                    <div class="footer-col">
                        <h4>Para empresas</h4>
                        <ul>
                            <li><a href="#">FasTICKET e seu negócio</a></li>
                            <li><a href="#">Comprar para sua empresa</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Footer -->

        <!-- Modal termo de geração -->
        <div class="term-modal-container" id="termAcceptance">    
            <div class="term-modal">
                <div class="nav-term-modal">
                    <h1 class="term-modal-title">Termos e Condições de Uso</h1>
                </div>
                
                <div class="term-modal-text">
                    <span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur nec leo at felis ultricies pellentesque ut eget tortor. Nunc sit amet mi sed tortor ornare mattis. Proin quis risus ac nibh fermentum ultricies pulvinar at diam. Phasellus vestibulum sit amet eros quis lacinia. Phasellus sagittis, neque et vestibulum interdum, sapien tortor malesuada leo, nec tempus nibh dolor egestas metus. Curabitur ornare at nulla sodales pellentesque. Aenean tristique sodales metus sed rutrum. Sed egestas sem mauris, sagittis dapibus nibh malesuada in. Ut et tortor condimentum, posuere neque lacinia, condimentum nisl. Proin nec gravida neque. Fusce molestie egestas tellus, eget semper ex volutpat a. Aliquam felis tellus, pretium eu ante eu, feugiat auctor diam.</span>
                </div>
                
                <div class="term-modal-footer">
                    <button type="button" class="generic-btn term-modal-btn" id="btnGenerate">
                        Confirmar
                    </button>
                    <button type="button" class="generic-btn term-modal-btn" id="cancel">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
        <!-- Modal termo de geração -->

        <!-- Geração do código -->
        <script src="../js/createTicket.js"></script>
        <script>
            const createTicketBtn = document.getElementById('btnGenerate');
            const qrCodeImg = document.getElementById('qrCodeImg');
            const ticketCode = document.getElementById('ticketCode');

            createTicketBtn.addEventListener('click', async () => {
                let newTicketCode = await createTicket();

                console.log(newTicketCode)
                qrCodeImg.src = `https://api.qrserver.com/v1/create-qr-code/?data=${newTicketCode.TICKET_ID}&size=183x183`;

                ticketCode.value = newTicketCode.TICKET_ID || newTicketCode.error;

                navigator.clipboard.writeText(newTicketCode.TICKET_ID);
            })
        </script>
        <!-- Geração do código -->

        <script src="../js/modal.js"></script>        
    </body>
</html>